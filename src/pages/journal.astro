---
import CenteredLayout from "../layouts/CenteredLayout.astro";
import { getCollection, render } from "astro:content";

// Get all journal entries sorted by date
const entries = await Promise.all(
    (await getCollection("journal")).sort(
        (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
    ).map(async (entry) => {
        const { Content } = await render(entry);
        return { ...entry, Content };
    })
);

const title = "Journal";
const description = "Daily logs, thoughts, and quick updates.";
---

<CenteredLayout title={title} description={description}>
	<section class="py">
		<p class="text-sm pb-4">
			{description}
		</p>
		<div class="space-y-8">
			{
				entries.map(({ data, Content }) => (
					<div class="group">
						<span class="text-gray-400 text-xs tracking-tight block mb-1">
							{data.pubDate.toLocaleDateString("en-us", {
								year: "numeric",
								month: "long",
								day: "numeric",
							})}
						</span>
						<h2 class="font-bold text-lg mb-2 group-hover:text-amber-100 transition-colors">
							{data.title}
						</h2>
						<div class="prose prose-sm prose-invert max-w-none text-gray-300">
							<Content />
						</div>
					</div>
				))
			}
		</div>
	</section>
</CenteredLayout>
